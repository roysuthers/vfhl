<!DOCTYPE html>
<html lang="en">
    <head>
        <title>VFHL Player Statistics</title>

        <script type="text/javascript" src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

        <!-- JQuery -->
        <!-- JQuery UI - A collection of Javascript widgets as well as a styling framework -->
        <!-- DataTables - Enhance HTML tables with advanced interaction controls -->
        <!-- Buttons - A common framework for user interaction buttons -->
        <!--   Column visbility - End user buttons to control column visibility -->
        <!--   HTML5 export  - Copy to clipboard and create Excel, PDF and CSV files from the table's data. -->
        <!--     jSZip  - Required for the Excel HTML5 export button visibility control -->
        <!-- DateTime - Date picker used in Editor, SearchBuilder and other components for DataTables  -->
        <!-- FixedColumns: Fix one or more columns to the left or right of a scrolling table. -->
        <!-- FixedHeader:  Sticky header and / or footer for the table -->
        <!-- SearchBuilder: User defined complex search builder.-->
        <!-- SearchPanes: Search panels for DataTables allowing rapid and customisable filtering. -->
        <!-- Select: Adds row, column and cell selection abilities to a table. -->
        <link href="https://cdn.datatables.net/v/ju/jszip-3.10.1/dt-1.13.6/b-2.4.2/b-colvis-2.4.2/b-html5-2.4.2/date-1.5.1/fc-4.3.0/fh-3.4.0/sb-1.6.0/sp-2.2.0/sl-1.7.0/datatables.min.css" rel="stylesheet">
        <script src="https://cdn.datatables.net/v/ju/jszip-3.10.1/dt-1.13.6/b-2.4.2/b-colvis-2.4.2/b-html5-2.4.2/date-1.5.1/fc-4.3.0/fh-3.4.0/sb-1.6.0/sp-2.2.0/sl-1.7.0/datatables.min.js"></script>

        <!-- Context menu -->
        <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/jquery-contextmenu/2.9.2/jquery.contextMenu.css">
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-contextmenu/2.9.2/jquery.contextMenu.min.js"></script>

        <!-- Date Range Picker -->
        <script type="text/javascript" src="https://cdn.jsdelivr.net/momentjs/latest/moment.min.js"></script>
        <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/daterangepicker/daterangepicker.min.js"></script>
        <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/daterangepicker/daterangepicker.css" />

    </head>
    <body>

        <style>

            .stat_gen_args {
                display: flex;
                flex-wrap: wrap;
                align-items: center;
                justify-content: flex-start;
            }

            .stat_gen_args .form-group {
                display: flex;
                flex-direction: column;
                margin-bottom: 20px;
                margin-right: 20px;
            }

            .stat_gen_args .form-group > div {
                display: flex;
                flex-wrap: wrap;
            }

            .stat_gen_args .form-group label {
                font-size: 1em;
                margin-bottom: 5px;
            }

            .single-element-container {
                display: flex;
                flex-direction: column;
                align-items: center;
            }

            .multi-checkbox-container {
                display: flex;
                justify-content: space-between;
            }

            .multi-checkbox-container > div {
                margin-right: 10px;
            }

            /* .single-element-container > div {
                display: flex;
                flex-direction: column;
                align-items: center;
            } */

            .stat_gen_args select {
                min-width: 150px;
                font-size: 1em;
            }

            #ewmaSpan {
                width: 50px;
                font-size: 1em;
            }

            .pulsing-bar {
                display: none;
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 10px;
                background-color: #3498db;
                /* remove the existing 'animation' rule */
                /* animation: pulse 1s infinite; */
                animation: none;
                /* add a new 'steps' animation rule */
                animation-name: progress;
                animation-duration: 2s;
                animation-iteration-count: infinite;
            }

            @keyframes progress {
                0% {
                    /* start off at the left edge */
                    transform: translateX(-100%);
                    opacity: 1;
                }
                10% {
                    /* move to the first step */
                    transform: translateX(-90%);
                    opacity: 1;
                }
                20% {
                    /* move to the second step */
                    transform: translateX(-80%);
                    opacity: 1;
                }
                /* repeat for all 10 steps */
                30% { transform: translateX(-70%); opacity: 1; }
                40% { transform: translateX(-60%); opacity: 1; }
                50% { transform: translateX(-50%); opacity: 1; }
                60% { transform: translateX(-40%); opacity: 1; }
                70% { transform: translateX(-30%); opacity: 1; }
                80% { transform: translateX(-20%); opacity: 1; }
                90% { transform: translateX(-10%); opacity: 1; }
                100% {
                    /* move to the right edge */
                    transform: translateX(0%);
                    opacity: 1;
                }
            }

            .odd-row {
                color: white;  /* Change 'black' to your desired color for odd rows */
            }

            .even-row {
                color: red;  /* Change 'red' to your desired color for even rows */
            }

            #managerSummary, #categoryScarcity , #categoryScarcityByZScoreRange, #draftBoard {
                margin-left: 0;
                margin: 10px;
                white-space: nowrap;
            }

            #managerSummary tr:first-child th[colspan="12"] {
                background-color: darkcyan;
            }

            #managerSummary tr:first-child th[colspan="7"] {
                background-color: lightgreen;
            }

            #managerSummary .centered-header th,
            #managerSummary th[colspan],
            #categoryScarcityByZScoreRange th[colspan="9"],
            #categoryScarcityByZScoreRange th[colspan="4"] {
                text-align: center;
            }

            #categoryScarcityContainer, #managerSummaryContainer {
                display: none;
                flex-wrap: wrap;
            }

            #draftButtonsWrapper, #autoAssignDraftPicks, #manuallySelectMyPicks, #undoDraftPick {
                display: inline-block!important;
                font-size: 1em;
            }

            #draftButtonsWrapper.hidden, #autoAssignDraftPicksContainer.hidden, #undoDraftPick.hidden {
                display: none!important;
            }

            input[type="date"] {
                width: 200px;
                font-size: 1em;
            }

            input[type="number"] {
                width: 50px;
                font-size: 1em;
            }

            #dateRange {
                width: 200px;
                font-size: 1em;
            }

            #statType {
                font-size: 1em;
            }

            .indented {
                margin-left: 20px;
            }

        </style>

        <div class="stat_gen_args">
            <div class="form-group">
                <label for="poolID">FANTRAX POOL</label>
                <div>
                    <select id="poolID" class="trigger_getRawData">
                        <option value=0>None</option>
                        <option value=9>VFHL 2018-2019</option>
                        <option value=10>VFHL 2019-2020</option>
                        <option value=8>VFHL 2020-2021</option>
                        <option value=4>VFHL 2021-2022</option>
                        <option value=6>VFHL 2022-2023</option>
                        <option value=7>VFHL 2023-2024</option>
                        <option value=11 selected>VFHL 2024-2025</option>
                    </select>
                </div>
            </div>
            <div class="form-group">
                <label for="gameType">GAME TYPE</label>
                <div>
                    <select id="gameType" class="trigger_getRawData">
                        <option value="Regular Season" selected>Regular Season</option>
                        <option value="Playoffs">Playoffs</option>
                        <option value="Projected Season">Projected Season</option>
                    </select>
                </div>
            </div>
            <div class="form-group" id="projectionSourceWrap">
                <label for="projectionSource">PROJECTION SOURCE</label>
                <div>
                    <select id="projectionSource" class="trigger_getRawData">
                        <option value="Averaged" selected>Averaged</option>
                        <option value="Athletic">The Athletic</option>
                        <option value="Dobber">Dobber</option>
                        <option value="Fantrax">Fantrax</option>
                    </select>
                </div>
            </div>
            <div class="form-group">
                <div>
                    <label class="radio-label"><input id="seasonRadioButton" type="radio" name="seasonOrDate" value="season" checked class="trigger_getRawData">SEASON RANGE</label>
                    <label class="radio-label"><input id="dateRadioButton" type="radio" name="seasonOrDate" value="date" class="trigger_getRawData">DATE RANGE</label>
                </div>
                <div>
                    <div id="seasonControls">
                        <select id="fromSeason" class="trigger_getRawData"></select>
                        <select id="toSeason" class="trigger_getRawData"></select>
                    </div>
                    <div id="dateControls" style="display: none;">
                        <input id="fromDate" type="date" style="display: none;" class="trigger_getRawData">
                        <input id="toDate" type="date" style="display: none;" class="trigger_getRawData">
                        <!-- <input id="dateRange" type="text"> -->
                        <div id="dateRange" style="background: #fff; cursor: pointer; padding: 5px 10px; border: 1px solid #ccc; width: 100%">
                            <i class="fa fa-calendar"></i>&nbsp;
                            <span></span> <i class="fa fa-caret-down"></i>
                        </div>
                    </div>
                </div>
            </div>
            <div class="form-group">
                <label for="statType">STATISTIC TYPE</label>
                <div>
                    <select id="statType" style="margin-right: 20px;" class="trigger_aggregateData">
                        <option value="Cumulative" selected>Cumulative</option>
                        <option value="Per game">Per game</option>
                        <option value="Per 60 minutes">Per 60 minutes</option>
                        <option value="EWMA">EWMA</option>
                    </select>
                </div>
            </div>
            <div class="form-group ewma" style="display: none;">
                <label for="ewmaSpan">EWMA Span</label>
                <div class="single-element-container">
                    <input type="number" id="ewmaSpan" value="10" min="1"  max="20" class="trigger_aggregateData">
                </div>
            </div>
            <div class="form-group">
                <label for="positionalScoringCheckbox">SCORES BY POSITION</label>
                <div class="single-element-container">
                    <input type="checkbox" id="positionalScoringCheckbox" class="trigger_calculateScores">
                </div>
            </div>
            <div class="form-group" id="calcZScoresContainer">
                <label for="positionalScoringCheckbox">SCORES COMPOSITION</label>
                <div class="multi-checkbox-container">
                    <div>
                        <label for="points">D-PTS:</label>
                        <input type="checkbox" id="points" name="points" checked class="trigger_calculateScores">
                    </div>
                    <div>
                        <label for="goals">GOALS:</label>
                        <input type="checkbox" id="goals" name="goals" checked class="trigger_calculateScores">
                    </div>
                    <div>
                        <label for="assists">ASSISTS:</label>
                        <input type="checkbox" id="assists" name="assists" checked class="trigger_calculateScores">
                    </div>
                    <div>
                        <label for="powerplayPoints">PPP:</label>
                        <input type="checkbox" id="powerplayPoints" name="powerplayPoints" checked class="trigger_calculateScores">
                    </div>
                    <div>
                        <label for="shotsOnGoal">SOG:</label>
                        <input type="checkbox" id="shotsOnGoal" name="shotsOnGoal" checked class="trigger_calculateScores">
                    </div>
                    <div>
                        <label for="blockedShots">BLK:</label>
                        <input type="checkbox" id="blockedShots" name="blockedShots" checked class="trigger_calculateScores">
                    </div>
                    <div>
                        <label for="hits">HITS:</label>
                        <input type="checkbox" id="hits" name="hits" checked class="trigger_calculateScores">
                    </div>
                    <div>
                        <label for="takeaways">TK:</label>
                        <input type="checkbox" id="takeaways" name="takeaways" checked class="trigger_calculateScores">
                    </div>
                    <div>
                        <label for="penaltyMinutes">PIM:</label>
                        <input type="checkbox" id="penaltyMinutes" name="penaltyMinutes" checked class="trigger_calculateScores">
                    </div>
                    <!-- Don't show Goalie categories, but keep checkboxes so that they always get calculated -->
                    <div>
                        <label for="wins" style="display: none">WINS:</label>
                        <input type="checkbox" id="wins" name="wins" checked class="trigger_calculateScores" style="display: none">
                    </div>
                    <div>
                        <label for="saves" style="display: none">SAVES:</label>
                        <input type="checkbox" id="saves" name="saves" checked class="trigger_calculateScores" style="display: none">
                    </div>
                    <div>
                        <label for="gaa" style="display: none">GAA:</label>
                        <input type="checkbox" id="gaa" name="gaa" checked class="trigger_calculateScores" style="display: none">
                    </div>
                    <div>
                        <label for="savePercent" style="display: none">SAVE%:</label>
                        <input type="checkbox" id="savePercent" name="savePercent" class="trigger_calculateScores" checked style="display: none">
                    </div>
                    <!-- -->
                </div>
            </div>
            <div class="form-group">
                <button id="applyButton" style="font-size: 1.5em;">Apply</button>
            </div>

        </div>

        <div id="toggleCheckboxContainer" style="display: none;" class="indented form-group">
            <input type="checkbox" id="toggleSummary" onclick="toggleManagerSummary()">SHOW MANAGER SUMMARY</input>
            <input type="checkbox" id="toggleScarcity" onclick="toggleCategoryScarcity()">SHOW CATEGORY SCARCITY</input>
        </div>

        <div id="managerSummaryContainer">
            <table id="managerSummary" class="display cell-border hover compact">
                <caption style="caption-side: top; margin-bottom: 10px;"><b><u>Manager Scores</u></b></caption>
            </table>
        </div>

        <div id="categoryScarcityContainer">
            <div id="myCategoryNeedsContainer">
                <!-- new manager tables will be appended here -->
            </div>
            <table id="categoryScarcity" class="display cell-border hover compact">
                <caption style="caption-side: top; margin-bottom: 10px;"><b><u>Category Scarcity</u></b></caption>
            </table>
            <table id="categoryScarcityByZScoreRange" class="display cell-border hover compact">
                <caption style="caption-side: top; margin-bottom: 10px;"><b><u>Category Scarcity by Z-Score Range</u></b></caption>
            </table>
        </div>

        <p>
            <div class="hidden form-group" id="draftButtonsWrapper">
                <button id="startDraftButton" style="font-size: 1.5em;">Start Draft</button>
                <button id="draftSummariesButton" class="indented" style="font-size: 1.5em;">Get Draft Summary</button>
                <label class="indented" for="draftProjectionSource">DRAFT SUMMARY SOURCE:</label>
                <select id="draftProjectionSource" class="trigger_getRawData" style="font-size: 1em;">
                    <option value="" selected>All</option>
                    <option value="Averaged">Averaged</option>
                    <option value="Athletic">The Athletic</option>
                    <option value="Dobber">Dobber</option>
                    <option value="Fantrax">Fantrax</option>
                </select>
            </div>
        </p>

        <p>
            <div id="autoAssignDraftPicksContainer" class="hidden indented">
                <input type="checkbox" id="manuallySelectMyPicks" name="manuallySelectMyPicks">
                <label for="manuallySelectMyPicks">Manually select my picks</label>
                <label for="iterations" class="indented">Iterations:</label>
                <input type="number" id="iterations" name="iterations" min="1" value="1">
                <input type="checkbox" id="writeToDraftSimulationsTable" name="writeToDraftSimulationsTable" class="indented">
                <label for="writeToDraftSimulationsTable">Write to Draft Simulations Table</label>
                <input type="checkbox" id="clearDraftSimulationsTable" name="clearDraftSimulationsTable" class="indented">
                <label for="clearDraftSimulationsTable">Clear Draft Simulations Table</label>
                <button id="autoAssignDraftPicks" class="indented">Auto-assign Draft Picks</button>
            </div>
        </p>

        <table id="draftBoard" class="display cell-border hover compact panel-body" style="display:none">
            <caption style="caption-side: top; margin-bottom: 10px;"><b><u>Draft Board</u></b></caption>
        </table>

        <p style="text-align: center;">
            <button id="undoDraftPick" class="hidden" style="font-size: 1.5em;">Undo Previous Pick</button>
        </p>

        <p>
            <div id='draftMessage' style="display: none; font-size: 2em; text-align: center;">
                <b>Draft has started...</b>
            </div>
        </p>

        <div id="player_stats-div" class="display cell-border hover compact panel-body" style="display:none">
            <table id="player_stats">
                <caption style="caption-side: top; margin-bottom: 10px;"><b><u>Player Statistics</u></b></caption>
            </table>
        </div>

        <div id="pulsing-bar" class="pulsing-bar"></div>

        <script src="./javascript/data_tables.js"></script>

        <script>

            // Get references to the radio buttons and control elements
            const poolID = document.querySelector('#poolID');
            const gameType = document.querySelector('#gameType');
            const seasonOrDateRadios = document.querySelectorAll('input[name="seasonOrDate"]');
            const seasonControls = document.querySelector('#seasonControls');
            const fromSeason = document.querySelector('#fromSeason');
            const toSeason = document.querySelector('#toSeason');
            const dateControls = document.querySelector('#dateControls');
            const fromDate = document.querySelector('#fromDate');
            const toDate = document.querySelector('#toDate');
            const dateRange = document.querySelector('#dateRange');
            const projectionSource = document.querySelector('#projectionSource');
            const projectionSourceLabel = document.querySelector('#projectionSourceWrap label');
            const statType = document.querySelector("#statType");
            const ewmaSpan = document.querySelector("#ewmaSpan");

            const upcomingSeason = '20242025';

            // Object to store the start and end dates for each season
            const regularSeasonDates = {
                '20182019': { startDate: '2018-10-03', endDate: '2019-04-06' },
                '20192020': { startDate: '2019-10-02', endDate: '2020-03-11' },
                '20202021': { startDate: '2021-01-13', endDate: '2021-05-19' },
                '20212022': { startDate: '2021-10-12', endDate: '2022-05-01' },
                '20222023': { startDate: '2022-10-07', endDate: '2023-04-14' },
                '20232024': { startDate: '2023-10-10', endDate: '2024-04-18' },
                '20242025': { startDate: '2024-10-10', endDate: '2025-04-18' },
            };

            // Object to store the start and end dates for each season
            const playoffsSeasonDates = {
                '20212022': { startDate: '2022-05-02', endDate: '2022-06-30' },
                '20222023': { startDate: '2023-04-17', endDate: '2023-06-19' },
                '20232024': { startDate: '2023-04-20', endDate: '2023-06-18' },
            };

            // Object to store the start and end dates for the next season's projections
            const projectedSeasonDates = {
                '20232024': { startDate: '2023-10-10', endDate: '2024-04-18' },
                '20242025': { startDate: '2024-10-10', endDate: '2025-04-18' },
            };

            // trigger change event on first select
            fromSeason.dispatchEvent(new Event('change'));

            fromSeason.addEventListener('change', () => {

                // remove all options from second select
                while (toSeason.firstChild) {
                    toSeason.removeChild(toSeason.firstChild);
                }

                // clone options from first select and append them to second select
                for (const option of fromSeason.options) {
                    const clonedOption = option.cloneNode(true);
                    toSeason.appendChild(clonedOption);
                }

                const selectedValue = fromSeason.value;

                // remove options from second select, if less than the selected value
                while (toSeason.firstChild) {
                    if (toSeason.querySelector('option').value < selectedValue){
                        toSeason.removeChild(toSeason.firstChild);
                    } else {
                        break;
                    }
                }

            });

            // Add event listeners to the pool selector to listen for changes
            poolID.addEventListener('change', () => {
                setSeasons();
                setDateValues();
                setProjectionSourceVisibility();
                updateStatTypeOptions();
            });

            // Add event listeners to the gameType selector to listen for changes
            gameType.addEventListener('change', () => {
                if (gameType.value === 'Projected Season') {
                    // Check the 'season' radio button
                    document.querySelector('input[name="seasonOrDate"][value="season"]').checked = true;
                    updateControls();
                }
                setSeasons();
                setDateValues();
                setProjectionSourceVisibility();
                updateStatTypeOptions();
            });

            // execute the setDateValues function when the page is loaded
            document.addEventListener("DOMContentLoaded", function() {
                setSeasons();
                setDateValues();
                setProjectionSourceVisibility();
                updateStatTypeOptions();
            });

            // Function to update the display of the controls based on the selected radio button
            function updateControls() {
                if (seasonOrDateRadios[0].checked) {
                    seasonControls.style.display = 'block';
                    dateControls.style.display = 'none';
                } else {
                    seasonControls.style.display = 'none';
                    dateControls.style.display = 'block';
                }
            }

            // Function to set the values from & to seasons
            function setSeasons() {
                // Get the selected game type
                let selectedGameType = gameType.value;

                // Get references to the fromSeason and toSeason elements
                let fromSeason = document.querySelector('#fromSeason');
                let toSeason = document.querySelector('#toSeason');

                // Clear the current options in the fromSeason and toSeason elements
                fromSeason.innerHTML = '';
                toSeason.innerHTML = '';

                // Get a reference to the "DATE RANGE" radio button
                let dateRangeRadioButton = document.querySelector('input[type="radio"][value="date"]');

                // Create new options for the fromSeason and toSeason elements based on the selected game type
                if (selectedGameType === 'Regular Season') {
                    var seasons = Object.keys(regularSeasonDates);
                } else if (selectedGameType === 'Playoffs') {
                    seasons = Object.keys(playoffsSeasonDates);
                } else if (selectedGameType === 'Projected Season') {
                    seasons = Object.keys(projectedSeasonDates);
                }
                // Add options for seasons up to the latest season, to the fromSeason element
                seasons.forEach(season => {
                    let option = document.createElement('option');
                    option.value = season;
                    option.text = season.slice(0, 4) + '-' + season.slice(4);
                    fromSeason.add(option);
                });

                // Set the last option as the selected option
                // fromSeason.options[fromSeason.options.length - 1].selected = true;
                function findIndexByTextValue(selectElement, targetText) {
                    const optionsArray = Array.from(selectElement.options);
                    const index = optionsArray.findIndex((opt) => opt.text === targetText);
                    return index;
                }
                var targetText = poolID[poolID.selectedIndex].text.substr(-9);
                var idx = findIndexByTextValue(fromSeason, targetText);
                fromSeason.options[idx].selected = true;

                // Add options for all seasons starting with the selected season & up to the most recent season to the toSeason element
                let selectedFromSeason = fromSeason.value;
                let index = seasons.indexOf(selectedFromSeason);
                let availableToSeasons = seasons.slice(index);
                availableToSeasons.forEach(season => {
                    let option = document.createElement('option');
                    option.value = season;
                    option.text = season.slice(0, 4) + '-' + season.slice(4);
                    toSeason.add(option);
                });

                if (selectedGameType === 'Regular Season' || selectedGameType === 'Playoffs') {
                    dateRangeRadioButton.disabled = false;
                } else if (selectedGameType === 'Projected Season') {
                    dateRangeRadioButton.disabled = true;
                }
            };

            // function to set statType options based on selected gameType
            function updateStatTypeOptions() {

                if (gameType.value === "Projected Season") {
                    // Only allow the Cumulative option
                    statType.innerHTML = '<option value="Cumulative" selected>Cumulative</option>';
                    statType.setAttribute("readonly", true);
                } else {
                    // Allow all options
                    statType.innerHTML = '<option value="Cumulative" selected>Cumulative</option>' +
                                         '<option value="Per game">Per game</option>' +
                                         '<option value="Per 60 minutes">Per 60 minutes</option>' +
                                         '<option value="EWMA">EWMA</option>';
                    statType.removeAttribute("readonly");
                }
            }

            // Function to set the values of the date inputs based on the selected season
            function setDateValues() {

                // Set the values of the date inputs
                minDate = moment();
                maxDate = moment();
                if (gameType.value === 'Regular Season') {
                    minDate = moment(regularSeasonDates[fromSeason.value].startDate);
                    maxDate = moment(regularSeasonDates[fromSeason.value].endDate);
                } else if (gameType.value === 'Playoffs') {
                    minDate = moment(playoffsSeasonDates[fromSeason.value].startDate);
                    maxDate = moment(playoffsSeasonDates[fromSeason.value].endDate);
                } else { // "Projected Season"
                    return;
                }
                // Set maxDate to today only if today is earlier than the current maxDate
                const yesterday = moment().subtract(1, 'days'); // Get yesterday's date
                if (yesterday.isBefore(maxDate)) {
                    maxDate = yesterday;
                }
            }

            function setProjectionSourceVisibility() {
                // Get the selected game type
                let selectedGameType = gameType.value;
                // Show or hide the element based on the selected game type
                if (selectedGameType === 'Projected Season') {
                    projectionSource.style.display = 'inline-block';
                    projectionSourceLabel.style.display = 'inline-block';

                } else {
                    projectionSource.style.display = 'none';
                    projectionSourceLabel.style.display = 'none';
                }
            }

            // Add event listeners to the radio buttons to listen for changes
            seasonOrDateRadios.forEach(radio => {
                radio.addEventListener('change', () => {
                    // Call the updateControls function
                    updateControls();

                    // Call the setDateValues function if the "date" radio button is selected
                    if (radio.value === 'date') {
                        setDateValues();
                    }
                });
            });

            $(function() {

                setDateValues();
                var start = minDate;
                var end = maxDate;

                function cb(start, end) {
                    $('#dateRange span').html(start.format('MMMM D, YYYY') + ' - ' + end.format('MMMM D, YYYY'));
                    fromDate.value = start.format('YYYY-MM-DD');
                    toDate.value = end.format('YYYY-MM-DD');
                }

                $('#dateRange').daterangepicker({
                    startDate: start,
                    endDate: end,
                    ranges: {
                        // 'Today': [moment(), moment()],
                        'Yesterday': [moment().subtract(1, 'days'), moment().subtract(1, 'days')],
                        'Last 7 Days': [moment().subtract(7, 'days'), moment().subtract(1, 'days')],
                        'Last 14 Days': [moment().subtract(14, 'days'), moment().subtract(1, 'days')],
                        'Last 21 Days': [moment().subtract(21, 'days'), moment().subtract(1, 'days')],
                        'Last 30 Days': [moment().subtract(30, 'days'), moment().subtract(1, 'days')],
                        'Last 60 Days': [moment().subtract(60, 'days'), moment().subtract(1, 'days')],
                        'This Month': [moment().startOf('month'), moment().endOf('month')],
                        'Last Month': [moment().subtract(1, 'month').startOf('month'), moment().subtract(1, 'month').endOf('month')],
                        'This Calendar Year': [moment().startOf('year'), moment().endOf('year')],
                        'Last Calendar Year': [moment().subtract(1, 'year').startOf('year'), moment().subtract(1, 'year').endOf('year')],
                        'Last 12 Months': [moment().subtract(365, 'days'), moment().subtract(1, 'days')]
                    },
                    showDropdowns: true,
                    linkedCalendars: false,
                }, cb);

                cb(start, end);

            });

        </script>

        <script>
            function toggleManagerSummary() {
                var checkBox = document.getElementById("toggleSummary");
                var managerSummaryContainer = document.getElementById("managerSummaryContainer");
                if (checkBox.checked == true){
                    managerSummaryContainer.style.display = "flex";
                } else {
                    managerSummaryContainer.style.display = "none";
                }
            }
        </script>

        <script>
            function toggleCategoryScarcity() {
                var checkBox = document.getElementById("toggleScarcity");
                var categoryScarcityContainer = document.getElementById("categoryScarcityContainer");
                if (checkBox.checked == true){
                    categoryScarcityContainer.style.display = "flex";
                } else {
                    categoryScarcityContainer.style.display = "none";
                }
            }
        </script>

    </body>
</html>
